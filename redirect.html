<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Pemutar Film Aman</title>
<style>
body {
  margin: 0;
  background: #111;
  color: #eee;
  font-family: "Poppins", sans-serif;
  text-align: center;
  padding: 30px;
}
h1 {
  color: #00ffc8;
  margin-bottom: 8px;
}
video {
  width: 100%;
  max-width: 700px;
  border-radius: 10px;
  box-shadow: 0 0 20px rgba(0, 255, 200, 0.2);
  margin-top: 20px;
}
.hidden {
  display: none;
}
.box {
  background: #1b1b1b;
  border: 1px solid #333;
  border-radius: 10px;
  max-width: 600px;
  margin: auto;
  padding: 20px;
  box-shadow: 0 0 15px rgba(255, 255, 255, 0.05);
}
input, textarea {
  width: 90%;
  background: #222;
  color: #fff;
  border: 1px solid #444;
  border-radius: 6px;
  padding: 8px;
  margin: 5px 0;
  font-size: 14px;
}
button {
  background: #00ffc8;
  border: none;
  color: #000;
  padding: 10px 16px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: bold;
  margin-top: 8px;
}
button:hover {
  background: #00e6b8;
}
.result-box {
  background: #181818;
  border: 1px solid #333;
  margin-top: 15px;
  padding: 10px;
  border-radius: 8px;
  text-align: left;
  font-family: monospace;
  word-break: break-all;
}
</style>
</head>
<body>
<h1>üé¨ Pemutar Film Aman</h1>
<p>Link asli tidak akan terlihat ‚Äî diputar langsung di sini.</p>

<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

<script>
// ======================
// üîê DAFTAR FILM TERENKRIPSI
// ======================
const secureLinks = [
  {
    code: "film1",
    key: "4Bu52RkvRMtLVFKg%!hD^rpkio*3DdQg",
    data: "U2FsdGVkX18Cw+3Lzjcjc21Fry+QefCrroLoEKqI9Mk9h0bLuwBw1aGMvgDRhirRffbx8qFmomI5fbfZraujwcswH39WkHAceEyrtLK4pIg7NVvctKn+jTmuR6Lr8fwfRctJADKAjkvlXPVMPrglmtT2KE7rXl9jZDwD2U1VmXw="
  }
];

// ======================
// üîì FUNGSI DEKRIPSI
// ======================
function decryptAES(cipher, key) {
  try {
    const bytes = CryptoJS.AES.decrypt(cipher, key);
    return bytes.toString(CryptoJS.enc.Utf8);
  } catch (e) {
    return null;
  }
}

// ======================
// üé¨ LOGIKA PEMUTAR
// ======================
const params = new URLSearchParams(window.location.search);
let filmCode = [...params.keys()][0];

// Tambahan: agar ?ukiekey tanpa "=" tetap bisa dibaca
if (window.location.search.includes("ukiekey")) {
  filmCode = "ukiekey";
}

if (filmCode && filmCode !== "ukiekey") {
  const found = secureLinks.find(x => x.code === filmCode);
  if (found) {
    const decrypted = decryptAES(found.data, found.key);
    if (decrypted) {
      document.body.innerHTML = `
        <h1>üé¨ Memutar Film: ${found.code}</h1>
        <video id="player" controls autoplay></video>
      `;
      const player = document.getElementById("player");
      player.src = decrypted;
      player.play().catch(() => {});
    } else {
      document.body.innerHTML = "<h2>‚ùå Gagal membuka tautan terenkripsi.</h2>";
    }
  } else {
    document.body.innerHTML = "<h2>‚ö†Ô∏è Kode film tidak ditemukan.</h2>";
  }
}

// ======================
// üîß PANEL ADMIN RAHASIA (?ukiekey)
// ======================
if (filmCode === "ukiekey") {
  document.body.innerHTML = `
  <div class="box">
    <h2>Panel Admin üîê</h2>
    <p>Gunakan untuk membuat link terenkripsi baru.</p>
    <input type="text" id="filmCode" placeholder="Kode film (misal: film2)">
    <textarea id="filmURL" rows="3" placeholder="Tempel link asli film di sini..."></textarea>
    <button onclick="generate()">Enkripsi</button>
    <div id="result" class="result-box hidden"></div>
  </div>
  `;
}

function generate() {
  const code = document.getElementById("filmCode").value.trim();
  const link = document.getElementById("filmURL").value.trim();
  if (!code || !link) return alert("Isi semua kolom dulu!");
  const randomKey = Math.random().toString(36).substring(2, 18);
  const cipher = CryptoJS.AES.encrypt(link, randomKey).toString();
  const result = `{ code: "${code}", key: "${randomKey}", data: "${cipher}" }`;
  const out = document.getElementById("result");
  out.classList.remove("hidden");
  out.innerHTML = "<strong>Hasil:</strong><br><pre>" + result + "</pre>";
}
</script>

</body>
</html>
